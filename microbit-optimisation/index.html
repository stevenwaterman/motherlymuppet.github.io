<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta
			name="description"
			content="I'm a software developer, technical coach, over-analyser. This is where I do those things. Mostly over-analysing."
		/>
		<link rel="icon" href="/favicon.png" />
		<link rel="stylesheet" href="/global.css" />
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta http-equiv="content-security-policy" content=""><title>Optimise your Micro:Bit code with Chrome DevTools</title><meta name="description" content="Some might say I pushed the Micro:Bit too far. This post is not for those people. If your Micro:Bit is also struggling, this post will show you how to optimise your code and push it further"><link rel="alternate" type="application/rss+xml" href="https://stevenwaterman.uk/rss.xml" title="Steven Waterman's Blog"><link rel="canonical" href="https://stevenwaterman.uk/microbit-optimisation"><meta property="og:title" content="Optimise your Micro:Bit code with Chrome DevTools"><meta property="og:description" content="Some might say I pushed the Micro:Bit too far. This post is not for those people. If your Micro:Bit is also struggling, this post will show you how to optimise your code and push it further"><meta property="og:image" content="https://stevenwaterman.uk/assets/blog/microbit-optimisation/header.png"><meta property="og:type" content="article"><meta property="og:site_name" content="Steven Waterman"><meta property="og:url" content="https://stevenwaterman.uk/microbit-optimisation"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@SteWaterman"><meta name="twitter:image" content="https://stevenwaterman.uk/assets/blog/microbit-optimisation/header.png"><meta name="twitter:creator" content="@SteWaterman">
	<link rel="stylesheet" href="/_app/assets/vendor-ec9510ad.css">
	<link rel="stylesheet" href="/_app/assets/BlogPost-27f41e79.css">
	<link rel="stylesheet" href="/_app/assets/Template-8f63f35a.css">
	<link rel="stylesheet" href="/_app/assets/Snippet-1ad9e017.css">
	</head>
	<body>
		






<div class="gradient svelte-1thle15"><div class="panX svelte-1atbztl"><div class="panY svelte-1atbztl"><div class="gradient svelte-1atbztl"></div></div></div></div>

<nav class="svelte-1nxg8xt"><a class="logoLink svelte-1nxg8xt" href="/"><img class="logo svelte-1nxg8xt" src="/assets/logoWhite.svg" alt="Logo">
		<span class="logoText svelte-1nxg8xt">SW</span></a>

	<div class="burgerMenuContainer svelte-1nxg8xt"><span tabindex="0" class="burgerMenuOpen svelte-1nxg8xt"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 448 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(224 256)" transform-origin="112 0"><g transform="translate(0,0) scale(1,1)"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" fill="currentColor" transform="translate(-224 -256)"></path></g></g></svg></span>

		<ul class="menu svelte-1nxg8xt"><li class="svelte-1nxg8xt"><span class="label svelte-101pjyx"><a class="topLink svelte-101pjyx" href="/">Blog</a>
  </span></li>

			<li class="svelte-1nxg8xt"><span class="label svelte-101pjyx"><a class="topLink svelte-101pjyx" href="/assets/cv.pdf">CV</a>
  </span></li>

			<li class="svelte-1nxg8xt"><span class="label svelte-101pjyx"><a class="topLink svelte-101pjyx">Socials</a>
  <div class="menu svelte-101pjyx"><div class="menu-arrow svelte-101pjyx"><div class="menu-arrow-fill svelte-101pjyx"></div></div>
      <div class="menu-content svelte-101pjyx"><ul class="svelte-101pjyx"><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://twitter.com/SteWaterman/">Twitter</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://github.com/StevenWaterman/">GitHub</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://www.linkedin.com/in/steven-waterman/">LinkedIn</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://twitch.tv/SteWaterman/">Twitch</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="mailto:website@stevenwaterman.uk">Email</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://calendly.com/stewaterman/30min">Calendly</a>
            </li></ul></div></div></span></li>

			<li class="svelte-1nxg8xt"><span class="label svelte-101pjyx"><a class="topLink svelte-101pjyx" href="/#community">Projects</a>
  <div class="menu svelte-101pjyx"><div class="menu-arrow svelte-101pjyx"><div class="menu-arrow-fill svelte-101pjyx"></div></div>
      <div class="menu-content svelte-101pjyx"><ul class="svelte-101pjyx"><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://tunescape07.com">TuneScape</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://stevenwaterman.uk/Balance/">Balance Scores</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://lexoral.com">Lexoral</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://stevenwaterman.uk/musetree/">MuseTree</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://stevenwaterman.uk/NoTimeToStalk">No Time to Stalk</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://github.com/stevenwaterman/narration.studio">Narration.Studio</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://stevenwaterman.uk/Spiro/">Spiro</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://linktr.ee/prevoid_art">Art</a>
            </li><li class="menuEntry svelte-101pjyx"><a class="menuLink svelte-101pjyx" href="https://soundcloud.com/user-872603169">Music</a>
            </li></ul></div></div></span></li>

			<li class="chat svelte-1nxg8xt"><div class="container svelte-1atmfra">
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
  <button onclick="Calendly.initPopupWidget({url: &#39;https://calendly.com/stewaterman/30min&#39;});return false;" class="svelte-1atmfra">Let&#39;sÂ Chat<span class="arrow svelte-1atmfra">&gt;</span></button>
  </div></li></ul></div>
</nav>

<div class="column svelte-1thle15"><div class="grid svelte-1quqrs0"><div class="textContainer svelte-11sshxl" style=""><article><a href="/assets/blog/microbit-optimisation/header.png"><img class="headerImage svelte-1quqrs0" src="/assets/blog/microbit-optimisation/header.png" style="object-fit: cover; object-position: center;" alt="Header"></a>
				<div class="padded svelte-1quqrs0"><div class="metadata svelte-1quqrs0"><p class="type svelte-1quqrs0">technical</p>
						<p class="date svelte-1quqrs0">Published <time>2020-03-27</time></p>
						<p class="author svelte-1quqrs0">By Steven Waterman</p></div>

					<h1 class="svelte-1quqrs0">Optimise your Micro:Bit code with Chrome DevTools</h1>

					<div class="topSection svelte-1quqrs0"><div class="left"><summary class="svelte-1quqrs0">Some might say I pushed the Micro:Bit too far. This post is not for those people. If your Micro:Bit is also struggling, this post will show you how to optimise your code and push it further</summary>

							<p class="original svelte-1quqrs0">Originally posted on <a href="https://blog.scottlogic.com/2020/03/27/microbit-optimisation.html">the Scott Logic blog</a></p>

							</div>

						</div>

					<hr class="svelte-1quqrs0">

					<p>When I <a href="https://blog.scottlogic.com/2020/03/10/raytracer-how-to.html">wrote a ray tracer</a> for the <a href="https://microbit.org/">BBC Micro:Bit</a>, I didn&#39;t expect it to be fast.
    I was right - my first attempt was unbearably slow, taking multiple seconds to respond to a button press.
    That meant I had to optimise my code, but the normal <a href="https://makecode.microbit.org/">MakeCode IDE</a> doesn&#39;t provide any tools to let you inspect your program while it&#39;s running.
    Instead, I reworked my code to <a href="https://stevenwaterman.uk/microbit-raytracer/">run as a website</a> and used Chrome&#39;s Developer Tools.
    My test bench code is available <a href="https://github.com/stevenwaterman/microbit-raytracer/tree/gh-pages">on GitHub</a>.
  </p>
  
  <p>This post walks you through how to build a test bench website for your code and use the Chrome Developer Tools to optimise it.
    It is aimed at more advanced Micro:Bit users, but you don&#39;t need any experience with HTML or web development in general.
    However, you will need a basic grasp of using the command line to navigate between folders and run commands.
  </p>

  <h2>Introduction to Profiling</h2>

  <p>When it comes to optimising your code, there are a lot of general tips I could give you.
    However, I can&#39;t give advice about your specific project.
    Thankfully, you can use a tool called a <a href="https://en.wikipedia.org/wiki/Profiling_(computer_programming)">profiler</a> for that.
  </p>

  <p>Profilers inspect your program during execution and generate a report.
    The report lists how often each function ran and how long they took.
    It also tells you how much memory was used, and where in your code the memory was allocated.
    This helps you find the &#39;hot spots&#39; in your code - the parts that are running frequently and taking a long time.
  </p>

  <figure><img src="/assets/blog/microbit-optimisation/header.png" alt="Some code with cartoon fire superimposed" title="If your code is this hot, you need more help than I can give"></figure>

  <p>In general, a profiler lets you know which bits of your code are causing slowness and need optimising.
    Since optimisation usually makes your code harder to read and maintain, this information comes in handy.
    We only want to optimise the parts of the code that need it most.
  </p>

  <p>The MakeCode IDE doesn&#39;t include a profiler, but we can rework our code to let us use a normal JavaScript profiler.
    Google Chrome has a JavaScript profiler built-in, and you can run it on any website using the <a href="https://developers.google.com/web/tools/chrome-devtools">Chrome Developer Tools</a>.
    In fact, Chrome is not unique here - most browsers include profilers in their developer tools.
    In this post, I&#39;ll focus on Chrome&#39;s profiler, so make sure you are using Chrome too if you are following along at home.
  </p>

  <h2>Building a Test Bench</h2>

  <p>Since Chrome&#39;s profiler only works on websites, we can&#39;t use it to profile your Micro:Bit project directly.
    Instead, we need to build a website that runs your code - known as a <a href="https://en.wikipedia.org/wiki/Test_bench">test bench</a>.
    That could be as simple as:
  </p>

  <figure class="container wide snippet svelte-1omgi29"><h2 class="name svelte-1omgi29">Simple Test Bench</h2>

	

	<code class="visualCode svelte-12l7s60" aria-hidden="true">

<div class="fromLine same svelte-19djgjm" aria-hidden="true">1</div>
  <div class="toLine same svelte-19djgjm" aria-hidden="true">1</div>
  <div class="code same svelte-19djgjm"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></div><div class="fromLine same svelte-19djgjm" aria-hidden="true">2</div>
  <div class="toLine same svelte-19djgjm" aria-hidden="true">2</div>
  <div class="code same svelte-19djgjm">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></div><div class="fromLine same svelte-19djgjm" aria-hidden="true">3</div>
  <div class="toLine same svelte-19djgjm" aria-hidden="true">3</div>
  <div class="code same svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./myCode.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></div><div class="fromLine same svelte-19djgjm" aria-hidden="true">4</div>
  <div class="toLine same svelte-19djgjm" aria-hidden="true">4</div>
  <div class="code same svelte-19djgjm">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></div><div class="fromLine same svelte-19djgjm" aria-hidden="true">5</div>
  <div class="toLine same svelte-19djgjm" aria-hidden="true">5</div>
  <div class="code same svelte-19djgjm"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></div></code>

<code class="sr-code svelte-12l7s60"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./myCode.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code>
</figure>

  <p>However, this only works if your program is pure JavaScript.
    Most Micro:Bit code uses the handy built-in functions, like <code>input.onButtonPressed</code> or <code>basic.clearScreen</code>.
    We will need to write some extra code to let us use those functions, known as <a href="https://en.wikipedia.org/wiki/Method_stub">stubbing</a> them.
  </p>

  <p>Stubbing a function means writing a simpler version of it, which can be used in place of the real version.
    For example, you could stub <code>radio.sendString</code> with a function that just writes the value in a text box.
    You could stub <code>input.onButtonPressed</code> like this:
  </p>

  <figure class="container wide snippet svelte-1omgi29"><h2 class="name svelte-1omgi29">Test Bench Stubs</h2>

	

	<code class="visualCode svelte-12l7s60" aria-hidden="true"><details class="svelte-19djgjm"><summary class="svelte-19djgjm">&lt;Show 17 identical lines&gt;</summary>
    <div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">A</span>: <span class="hljs-string">&quot;a&quot;</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">B</span>: <span class="hljs-string">&quot;b&quot;</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">AB</span>: <span class="hljs-string">&quot;ab&quot;</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="code hidden svelte-19djgjm">};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-title function_">aPressed</span> = (<span class="hljs-params"></span>) =&gt; {};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">8</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">8</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-title function_">bPressed</span> = (<span class="hljs-params"></span>) =&gt; {};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">9</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">9</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-title function_">abPressed</span> = (<span class="hljs-params"></span>) =&gt; {};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">10</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">10</div>
        <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">11</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">11</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">const</span> input = {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">12</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">12</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">onButtonPressed</span>: <span class="hljs-function">(<span class="hljs-params">button: <span class="hljs-built_in">string</span>, func: () =&gt; <span class="hljs-built_in">void</span></span>) =&gt;</span> {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">13</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">13</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">A</span>) aPressed = func;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">14</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">14</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">B</span>) bPressed = func;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">15</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">15</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">AB</span>) abPressed = func;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">16</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">16</div>
        <div class="code hidden svelte-19djgjm">  },</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">17</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">17</div>
        <div class="code hidden svelte-19djgjm">};</div></details>

<div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">A</span>: <span class="hljs-string">&quot;a&quot;</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">B</span>: <span class="hljs-string">&quot;b&quot;</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">AB</span>: <span class="hljs-string">&quot;ab&quot;</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="code hidden svelte-19djgjm">};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-title function_">aPressed</span> = (<span class="hljs-params"></span>) =&gt; {};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">8</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">8</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-title function_">bPressed</span> = (<span class="hljs-params"></span>) =&gt; {};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">9</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">9</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-title function_">abPressed</span> = (<span class="hljs-params"></span>) =&gt; {};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">10</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">10</div>
  <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">11</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">11</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">const</span> input = {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">12</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">12</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">onButtonPressed</span>: <span class="hljs-function">(<span class="hljs-params">button: <span class="hljs-built_in">string</span>, func: () =&gt; <span class="hljs-built_in">void</span></span>) =&gt;</span> {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">13</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">13</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">A</span>) aPressed = func;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">14</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">14</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">B</span>) bPressed = func;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">15</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">15</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">AB</span>) abPressed = func;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">16</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">16</div>
  <div class="code hidden svelte-19djgjm">  },</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">17</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">17</div>
  <div class="code hidden svelte-19djgjm">};</div></code>

<code class="sr-code svelte-12l7s60"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = {
  <span class="hljs-attr">A</span>: <span class="hljs-string">&quot;a&quot;</span>,
  <span class="hljs-attr">B</span>: <span class="hljs-string">&quot;b&quot;</span>,
  <span class="hljs-attr">AB</span>: <span class="hljs-string">&quot;ab&quot;</span>,
};

<span class="hljs-keyword">let</span> <span class="hljs-title function_">aPressed</span> = (<span class="hljs-params"></span>) =&gt; {};
<span class="hljs-keyword">let</span> <span class="hljs-title function_">bPressed</span> = (<span class="hljs-params"></span>) =&gt; {};
<span class="hljs-keyword">let</span> <span class="hljs-title function_">abPressed</span> = (<span class="hljs-params"></span>) =&gt; {};

<span class="hljs-keyword">const</span> input = {
  <span class="hljs-attr">onButtonPressed</span>: <span class="hljs-function">(<span class="hljs-params">button: <span class="hljs-built_in">string</span>, func: () =&gt; <span class="hljs-built_in">void</span></span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">A</span>) aPressed = func;
    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">B</span>) bPressed = func;
    <span class="hljs-keyword">if</span> (button === <span class="hljs-title class_">Button</span>.<span class="hljs-property">AB</span>) abPressed = func;
  },
};</code>
</figure>

  <p>Now, other parts of your code can call <code>input.onButtonPressed</code> just like on a real Micro:Bit.
    The final step is to add some HTML buttons to your test bench.
    When the <code>A</code> button is pressed, it should run the <code>aPressed</code> function from the stub.
  </p>

  <figure class="container wide snippet svelte-1omgi29"><h2 class="name svelte-1omgi29">Test Bench</h2>

	

	<code class="visualCode svelte-12l7s60" aria-hidden="true"><details class="svelte-19djgjm"><summary class="svelte-19djgjm">&lt;Show 11 identical lines&gt;</summary>
    <div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./myCode.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;aPressed()&quot;</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">8</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">8</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;bPressed()&quot;</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">9</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">9</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;abPressed()&quot;</span>&gt;</span>AB<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">10</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">10</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">11</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">11</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></div></details>

<div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./myCode.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;aPressed()&quot;</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">8</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">8</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;bPressed()&quot;</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">9</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">9</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;abPressed()&quot;</span>&gt;</span>AB<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">10</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">10</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">11</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">11</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></div></code>

<code class="sr-code svelte-12l7s60"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./myCode.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;aPressed()&quot;</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;bPressed()&quot;</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;abPressed()&quot;</span>&gt;</span>AB<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code>
</figure>

  <p>If you need a second example, you can look at my ray tracer&#39;s <a href="https://github.com/stevenwaterman/microbit-raytracer/tree/gh-pages">test bench</a>.
    There, I stubbed the LED screen using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">HTML canvas</a>.
    The resulting website looks like this:
  </p>

  <figure><img src="/assets/blog/microbit-optimisation/testbench.png" title="It's no pixar, but it's mine" alt="My test bench shows a red pyramid on the display, and has one button for each input you can give the micro:bit, including the two buttons and the tilt gestures"></figure>

  <p>Stubbing the Micro:Bit methods can be really hard at first, and it&#39;s often unclear what approach to take.
    Therefore, before you jump in and start stubbing the methods, you should think about whether you really need them.
    If your only goal is to test the performance of your program, do you really need to see the output of the LED display?
    If not, you can just comment out any lines that use the Micro:Bit functions.
  </p>

  <p>It&#39;s also important to remember that your computer is much faster than the Micro:Bit.
    That means that your code could run so quickly that it finishes before the profiler records any data!
    That happened in my case, so I had to increase the number of pixels in my ray tracer until it took a few seconds to run.
    You could even just run your program over and over again in a loop.
  </p>

  <h2>An Important Note</h2>

  <p>The &#39;JavaScript&#39; code used by the Micro:Bit is actually <a href="https://www.typescriptlang.org/">TypeScript</a>.
    TypeScript isn&#39;t natively supported by the browser, so we have to <a href="https://en.wikipedia.org/wiki/Source-to-source_compiler">transpile</a> it into JavaScript.
    The method is quite straightforward:
  </p>

  <ol><li><a href="https://www.npmjs.com/get-npm">Install npm</a> by clicking the link and following the instructions for your operating system</li>
    <li>Install TypeScript by running <code>npm install -g typescript</code> in the command line</li>
    <li>With your code in a file named <code>myCode.ts</code>, navigate to that folder and run <code>tsc myCode.ts</code></li></ol>

  <p>The compiled JavaScript will be written to a file called <code>myCode.js</code>, ready to be used in your test bench.
    You&#39;ll need to repeat the last step any time you make changes to <code>myCode.ts</code>.
  </p>

  <h2>Using the Profiler</h2>

  <p>Open up your HTML file and check that your code is running.
    If you haven&#39;t set up any outputs, it could be hard to tell - try adding <code>console.log(&quot;It&#39;s working!&quot;)</code> somewhere in your code.
    After recompiling and refreshing the web page, you should see the message printed in the console.
    To access the console, open developer tools by right-clicking on the page and selecting <code>Inspect Element</code>.
    Then, switch to the <code>Console</code> tab.
  </p>

  <p>Now we know that&#39;s all working, it&#39;s time to start inspecting your code.
    There are two tabs that we&#39;re interested in: <code>Performance</code> and <code>Memory</code>.
    The Performance tab shows you how long each function is taking, both on a per-call level, and in total.
    The Memory tab shows you where memory is being allocated and how much is being used while the program was running.
  </p>

  <h3>Performance</h3>

  <p>In the performance tab, press the circular <code>Record</code> button and start running your program.
    After a few seconds, press the button again to stop recording and wait for it to process.
    You should see something like this:
  </p>

  <figure><img src="/assets/blog/microbit-optimisation/performance.png" alt="The performance tab of developer tools is shown. It has a number of small squares for each function that ran" title="It's scary at first, but this is one of the most helpful things ever"></figure>

  <p>Time increases from left to right, and each rectangle is the function in your code that was running at the time.
    When one function is under another, it means that the bottom one was called by the top one.
    The name of the function is written on the rectangle.
    Zoom in and see which functions are taking the longest in your code.
    Those functions are the ones that you should try to optimise.
  </p>

  <p>I&#39;m not going to discuss <em>how</em> to optimise your code, because it&#39;s an entire topic in itself.
    A few techniques I&#39;d recommend looking into are:
  </p>

  <ul><li><a href="https://en.wikipedia.org/wiki/Memoization">Memoization</a>: When a function is called with some arguments for the first time, the result is stored in a lookup table. On future calls, the arguments are used to get the result from the lookup table, instead of computing it again.</li>
    <li><a href="https://en.wikipedia.org/wiki/Inline_expansion">Function Inlining</a>: Copying the contents of a function into the part of the code where you previously called that function, allowing you to remove the function. This is useful when a function gets called millions of times as each function call introduces a tiny delay.</li>
    <li><a href="https://en.wikipedia.org/wiki/Precomputation">Precomputation</a>: Calculating every possible result of a function externally and hard-coding it into your program. This helps when the range of arguments is very small and known in advance, but the calculation is so complex that there&#39;s no realistic way to run it on the Micro:Bit.</li>
    <li><a href="https://en.wikipedia.org/wiki/Lazy_loading">Lazy Loading</a>: Only calculate things when you&#39;re absolutely sure the result will get used. This is a good general principle to look out for in any project, and helps reduce wasted CPU time.</li></ul>

  <p>In the performance profiler, you may see that your program spends a lot of time doing *garbage collection* (GC).
    This happens when you use lots of memory in your program.
    High memory use means the JavaScript interpreter constantly has to pause execution and tidy up after you.
    If that is the case in your code, you should check out the <em>Memory</em> tab.
  </p>

  <h3>Memory</h3>

  <p>The memory tab works just like the performance tab.
    First, select the <code>Allocation Sampling</code> profile, then hit <code>Start</code>.
    Your code will run much slower while the memory profiler is running, so let it run for a while before clicking to stop the recording.
    After giving it a few seconds to generate the report, it should look something like this:
  </p>

  <figure><img src="/assets/blog/microbit-optimisation/memory.png" alt="Shows the memory tab in developer tools. There is a big list of different places that memory was allocated." title="Click an entry in the list to see more information about what is being saved in memory"></figure>

  <p>The default view is <code>Summary</code> but you should change that to <code>Containment</code>.
    Then, click to open the <code>Window / &lt;your url&gt;</code> category.
    Here, you will see all of the memory allocated by your code.
    The amount of memory allocated is written in the far-right column, <code>Retained Size</code>.
    Just to the left of that, it says which line of code allocated the memory, e.g. <code>myCode.js:85</code> means line 85.
    Look for any of your methods near the top of the list - those are the ones that are using the most memory and need fixing.
  </p>

  <p>The following code is an example of a function with high memory use because it creates a new object each time it gets called:
  </p>

  <figure class="container wide snippet svelte-1omgi29"><h2 class="name svelte-1omgi29">High Memory Usage</h2>

	

	<code class="visualCode svelte-12l7s60" aria-hidden="true"><details class="svelte-19djgjm"><summary class="svelte-19djgjm">&lt;Show 6 identical lines&gt;</summary>
    <div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-keyword">return</span> {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-attr">min</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values),</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="code hidden svelte-19djgjm">    <span class="hljs-attr">max</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values),</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="code hidden svelte-19djgjm">  };</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="code hidden svelte-19djgjm">}</div></details>

<div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-keyword">return</span> {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-attr">min</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values),</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="code hidden svelte-19djgjm">    <span class="hljs-attr">max</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values),</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="code hidden svelte-19djgjm">  };</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="code hidden svelte-19djgjm">}</div></code>

<code class="sr-code svelte-12l7s60"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">min</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values),
    <span class="hljs-attr">max</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values),
  };
}</code>
</figure>

  <p>To reduce the memory use of a function like that, try removing any object creation and instead store the result in a global variable.
    In our case, we could use two global variables, <code>minResult</code> and <code>maxResult</code>:
  </p>

  <figure class="container wide snippet svelte-1omgi29"><h2 class="name svelte-1omgi29">Low Memory Usage</h2>

	

	<code class="visualCode svelte-12l7s60" aria-hidden="true"><details class="svelte-19djgjm"><summary class="svelte-19djgjm">&lt;Show 7 identical lines&gt;</summary>
    <div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-attr">minResult</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-attr">maxResult</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="code hidden svelte-19djgjm">  minResult = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="code hidden svelte-19djgjm">  maxResult = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="code hidden svelte-19djgjm">}</div></details>

<div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-attr">minResult</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">let</span> <span class="hljs-attr">maxResult</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="code hidden svelte-19djgjm">  minResult = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="code hidden svelte-19djgjm">  maxResult = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="code hidden svelte-19djgjm">}</div></code>

<code class="sr-code svelte-12l7s60"><span class="hljs-keyword">let</span> <span class="hljs-attr">minResult</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">maxResult</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {
  minResult = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values);
  maxResult = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values);
}</code>
</figure>

  <p>Alternatively, you could create one object in a global variable and simply mutate its properties, like this:
  </p>

  <figure class="container wide snippet svelte-1omgi29"><h2 class="name svelte-1omgi29">Global State</h2>

	

	<code class="visualCode svelte-12l7s60" aria-hidden="true"><details class="svelte-19djgjm"><summary class="svelte-19djgjm">&lt;Show 9 identical lines&gt;</summary>
    <div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">const</span> rangeResult = {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
        <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">max</span>: <span class="hljs-number">0</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
        <div class="code hidden svelte-19djgjm">};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
        <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
        <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
        <div class="code hidden svelte-19djgjm">  rangeResult.<span class="hljs-property">min</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">8</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">8</div>
        <div class="code hidden svelte-19djgjm">  rangeResult.<span class="hljs-property">max</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">9</div>
        <div class="toLine hidden svelte-19djgjm" aria-hidden="true">9</div>
        <div class="code hidden svelte-19djgjm">}</div></details>

<div class="fromLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">1</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">const</span> rangeResult = {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">2</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">3</div>
  <div class="code hidden svelte-19djgjm">  <span class="hljs-attr">max</span>: <span class="hljs-number">0</span>,</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">4</div>
  <div class="code hidden svelte-19djgjm">};</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">5</div>
  <div class="code hidden svelte-19djgjm"> </div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">6</div>
  <div class="code hidden svelte-19djgjm"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">7</div>
  <div class="code hidden svelte-19djgjm">  rangeResult.<span class="hljs-property">min</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">8</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">8</div>
  <div class="code hidden svelte-19djgjm">  rangeResult.<span class="hljs-property">max</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values);</div><div class="fromLine hidden svelte-19djgjm" aria-hidden="true">9</div>
  <div class="toLine hidden svelte-19djgjm" aria-hidden="true">9</div>
  <div class="code hidden svelte-19djgjm">}</div></code>

<code class="sr-code svelte-12l7s60"><span class="hljs-keyword">const</span> rangeResult = {
  <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">max</span>: <span class="hljs-number">0</span>,
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getRange</span>(<span class="hljs-params">values: <span class="hljs-built_in">number</span>[]</span>) {
  rangeResult.<span class="hljs-property">min</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(values);
  rangeResult.<span class="hljs-property">max</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(values);
}</code>
</figure>

  <p>Using the profiler, you should be able to incrementally improve your code, focusing on the parts that need it most.
    That incremental approach lets you optimise as little of your code as possible, while still seeing positive results overall.
  </p>

  <h2>Conclusion</h2>

  <p>A profiler is a great way to start intelligently optimising your code.
    They help you focus your efforts on the areas that would benefit most from being optimised.
    Since optimisation usually makes your code harder to read and maintain, it&#39;s important to only optimise those &#39;hot spots&#39;.
  </p>

  <p>Hopefully, with the help of a profiler, you&#39;ll be able to take your Micro:Bit code to new heights!
  </p>

  <hr>

  <p>If you&#39;re interested in reading more about how profilers can be used to optimise code, check out one of my older blog posts <a href="/minesweeper-optimisation">Slow Code HATES him! Optimising a web app from 1 to 60fps</a>.
  </p>

					</div></article></div>

		

<div class="textContainer svelte-11sshxl" style="position: sticky; top: 1em;"><div class="authorCol svelte-1ghjldr"><div class="details svelte-1ghjldr"><img src="/assets/blog/authors/SteWaterman.jpg" alt="Steven Waterman" class="svelte-1ghjldr">
			<h2 class="name svelte-1ghjldr">Steven Waterman</h2>
			<p class="job svelte-1ghjldr">Over-thinker</p>
			</div>

		

		<ul class="links svelte-1ghjldr"><li class="svelte-1ghjldr"><a href="mailto:blog@stevenwaterman.uk" class="svelte-1ghjldr"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 512 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(256 256)" transform-origin="128 0"><g transform="translate(0,0) scale(1,1)"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z" fill="currentColor" transform="translate(-256 -256)"></path></g></g></svg> <span class="linkText svelte-1ghjldr">blog@stevenwaterman.uk</span></a></li>

			<li class="svelte-1ghjldr"><a href="https://calendly.com/stewaterman/30min" class="svelte-1ghjldr"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 448 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(224 256)" transform-origin="112 0"><g transform="translate(0,0) scale(1,1)"><path d="M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z" fill="currentColor" transform="translate(-224 -256)"></path></g></g></svg> <span class="linkText svelte-1ghjldr">Office Hours</span></a></li>

			<li class="svelte-1ghjldr"><a href="https://github.com/StevenWaterman/" class="svelte-1ghjldr"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 496 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(248 256)" transform-origin="124 0"><g transform="translate(0,0) scale(1,1)"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="currentColor" transform="translate(-248 -256)"></path></g></g></svg> <span class="linkText svelte-1ghjldr">@StevenWaterman</span></a></li>

			<li class="svelte-1ghjldr"><a href="https://twitter.com/SteWaterman/" class="svelte-1ghjldr"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 512 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(256 256)" transform-origin="128 0"><g transform="translate(0,0) scale(1,1)"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" fill="currentColor" transform="translate(-256 -256)"></path></g></g></svg> <span class="linkText svelte-1ghjldr">@SteWaterman</span></a></li>

			<li class="svelte-1ghjldr"><a href="https://twitch.tv/SteWaterman/" class="svelte-1ghjldr"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 512 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(256 256)" transform-origin="128 0"><g transform="translate(0,0) scale(1,1)"><path d="M391.17,103.47H352.54v109.7h38.63ZM285,103H246.37V212.75H285ZM120.83,0,24.31,91.42V420.58H140.14V512l96.53-91.42h77.25L487.69,256V0ZM449.07,237.75l-77.22,73.12H294.61l-67.6,64v-64H140.14V36.58H449.07Z" fill="currentColor" transform="translate(-256 -256)"></path></g></g></svg> <span class="linkText svelte-1ghjldr">@SteWaterman</span></a></li>

			<li class="svelte-1ghjldr"><a href="https://www.linkedin.com/in/steven-waterman/" class="svelte-1ghjldr"><svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 448 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(224 256)" transform-origin="112 0"><g transform="translate(0,0) scale(1,1)"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z" fill="currentColor" transform="translate(-224 -256)"></path></g></g></svg> <span class="linkText svelte-1ghjldr">@steven-waterman</span></a></li>

			</ul></div></div></div></div>




	</body>
</html>
